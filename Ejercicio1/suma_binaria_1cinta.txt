// Entrada: a+b donde a y b son números binarios
// Salida: resultado de a+b en binario
// Ejemplo: 11+1 => 100
//
// Algoritmo de Suma Binaria Implícita
// para Simulador de Máquina de Turing
// turingmachinesimulator.com
//
// Algoritmo: Restar repetidamente 1 del primer número
// y sumar 1 al segundo número hasta que el primer número sea cero

name: Suma Binaria (Algoritmo Implícito)
init: VERIFICAR_SI_CERO
accept: FIN

// Verificar si el primer número es cero
VERIFICAR_SI_CERO,+
BUSCAR_IZQ_CERO,_,<

VERIFICAR_SI_CERO,0
VERIFICAR_SI_CERO,0,>

VERIFICAR_SI_CERO,1
BUSCAR_IZQ_RESTAR1,1,<

// Ir al inicio del primer número para restar 1
BUSCAR_IZQ_RESTAR1,_
RESTAR1_COMPLEMENTO,_,>

BUSCAR_IZQ_RESTAR1,0
BUSCAR_IZQ_RESTAR1,0,<

BUSCAR_IZQ_RESTAR1,1
BUSCAR_IZQ_RESTAR1,1,<

// Complemento a 1 hasta encontrar +
RESTAR1_COMPLEMENTO,+
RESTAR1_SUMAR1_CEROS_HASTA_0,+,<

RESTAR1_COMPLEMENTO,0
RESTAR1_COMPLEMENTO,1,>

RESTAR1_COMPLEMENTO,1
RESTAR1_COMPLEMENTO,0,>

// Sumar 1 después del complemento (encontrar 0 desde derecha)
RESTAR1_SUMAR1_CEROS_HASTA_0,0
RESTAR1_SUMAR1_BUSCAR_FIN,1,>

RESTAR1_SUMAR1_CEROS_HASTA_0,1
RESTAR1_SUMAR1_CEROS_HASTA_0,0,<

// Encontrar el final del primer número
RESTAR1_SUMAR1_BUSCAR_FIN,+
RESTAR1_COMPLEMENTO_DER,+,<

RESTAR1_SUMAR1_BUSCAR_FIN,0
RESTAR1_SUMAR1_BUSCAR_FIN,0,>

RESTAR1_SUMAR1_BUSCAR_FIN,1
RESTAR1_SUMAR1_BUSCAR_FIN,1,>

// Complemento a 1 desde derecha (completar resta)
RESTAR1_COMPLEMENTO_DER,_
BUSCAR_DER_SUMAR1,_,>

RESTAR1_COMPLEMENTO_DER,0
RESTAR1_COMPLEMENTO_DER,1,<

RESTAR1_COMPLEMENTO_DER,1
RESTAR1_COMPLEMENTO_DER,0,<

// Ir al segundo número para sumar 1
BUSCAR_DER_SUMAR1,+
SUMAR1_BUSCAR_FIN,+,>

BUSCAR_DER_SUMAR1,0
BUSCAR_DER_SUMAR1,0,>

BUSCAR_DER_SUMAR1,1
BUSCAR_DER_SUMAR1,1,>

// Encontrar el final del segundo número
SUMAR1_BUSCAR_FIN,_
SUMAR1_CEROS_HASTA_0,_,<

SUMAR1_BUSCAR_FIN,0
SUMAR1_BUSCAR_FIN,0,>

SUMAR1_BUSCAR_FIN,1
SUMAR1_BUSCAR_FIN,1,>

// Sumar 1 al segundo número (propagar acarreo)
SUMAR1_CEROS_HASTA_0,+
SUMAR1_NECESITA_NUEVO_DIGITO,+,>

SUMAR1_CEROS_HASTA_0,0
BUSCAR_IZQ_CONTINUAR,1,<

SUMAR1_CEROS_HASTA_0,1
SUMAR1_CEROS_HASTA_0,0,<

// Manejar desbordamiento de acarreo a nuevo dígito
SUMAR1_NECESITA_NUEVO_DIGITO,_
SUMAR1_SOLO_ESCRIBIR_UNO,1,<

SUMAR1_NECESITA_NUEVO_DIGITO,0
SUMAR1_CARRY0_DESPLAZAR,X,>

SUMAR1_NECESITA_NUEVO_DIGITO,1
SUMAR1_CARRY1_DESPLAZAR,X,>

// Escribir 1 cuando el segundo número estaba vacío
SUMAR1_SOLO_ESCRIBIR_UNO,+
BUSCAR_IZQ_CONTINUAR,+,<

// Desplazar llevando un 0
SUMAR1_CARRY0_DESPLAZAR,_
SUMAR1_ESCRIBIR_ACARREO_Y_RETORNAR,0,<

SUMAR1_CARRY0_DESPLAZAR,0
SUMAR1_CARRY0_DESPLAZAR,0,>

SUMAR1_CARRY0_DESPLAZAR,1
SUMAR1_CARRY1_DESPLAZAR,1,>

// Desplazar llevando un 1
SUMAR1_CARRY1_DESPLAZAR,_
SUMAR1_ESCRIBIR_ACARREO_Y_RETORNAR,1,<

SUMAR1_CARRY1_DESPLAZAR,0
SUMAR1_CARRY0_DESPLAZAR,0,>

SUMAR1_CARRY1_DESPLAZAR,1
SUMAR1_CARRY1_DESPLAZAR,1,>

// Escribir último dígito acarreado y retornar
SUMAR1_ESCRIBIR_ACARREO_Y_RETORNAR,0
SUMAR1_ESCRIBIR_ACARREO_Y_RETORNAR,0,<

SUMAR1_ESCRIBIR_ACARREO_Y_RETORNAR,1
SUMAR1_ESCRIBIR_ACARREO_Y_RETORNAR,1,<

SUMAR1_ESCRIBIR_ACARREO_Y_RETORNAR,X
SUMAR1_REEMPLAZAR_X_CON_1,1,<

// Reemplazar marcador X con 1
SUMAR1_REEMPLAZAR_X_CON_1,+
BUSCAR_IZQ_CONTINUAR,+,<

// Retornar al inicio para repetir el ciclo
BUSCAR_IZQ_CONTINUAR,_
VERIFICAR_SI_CERO,_,>

BUSCAR_IZQ_CONTINUAR,+
BUSCAR_IZQ_CONTINUAR,+,<

BUSCAR_IZQ_CONTINUAR,0
BUSCAR_IZQ_CONTINUAR,0,<

BUSCAR_IZQ_CONTINUAR,1
BUSCAR_IZQ_CONTINUAR,1,<

// Limpiar ceros a la izquierda del resultado
BUSCAR_IZQ_CERO,_
BUSCAR_INICIO,_,>

BUSCAR_IZQ_CERO,0
BUSCAR_IZQ_CERO,_,<

// Encontrar el inicio del resultado
BUSCAR_INICIO,0
MOVER_DER_UNA_VEZ,0,<

BUSCAR_INICIO,1
MOVER_DER_UNA_VEZ,1,<

BUSCAR_INICIO,_
BUSCAR_INICIO,_,>

// Mover a la derecha una vez y terminar
MOVER_DER_UNA_VEZ,_
FIN,_,>
